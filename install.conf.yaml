- defaults:
    link:
      create: true
      relink: true
      force: false

- clean: ["~"]

- link:
    # Shell
    ~/.zshenv: .zshenv
    ~/.bashrc: .bashrc

    # XDG Config
    ~/.config/zsh: dotconfig/zsh
    ~/.config/mise: dotconfig/mise
    ~/.config/tmux: dotconfig/tmux
    ~/.config/git: dotconfig/git
    ~/.config/vim: dotconfig/vim
    ~/.config/starship.toml: dotconfig/starship.toml
    ~/.config/systemd: dotconfig/systemd
    ~/.config/environment.d: dotconfig/environment.d

    # Reverse Recursive Lookup
    ~/.editorconfig: .editorconfig

- create:
    - ~/Projects

- shell:
    - [
        git submodule update --init --recursive --progress,
        Installing submodules,
      ]

    - [
        command -v starship || curl -fsSL https://starship.rs/install.sh | sh -s -- -y -f,
        Installing Starship,
      ]
    - [command -v mise || curl https://mise.run | sh, Installing mise]
    # Install keychain on apt-based systems
    -
      command: 'command -v keychain || (sudo apt-get update && sudo apt-get install -y keychain)'
      description: Installing keychain (apt-based systems, only if missing)
      if: 'command -v apt-get'

    - [
        '[ -L ~/.ssh/config ] && rm ~/.ssh/config; mkdir -p ~/.ssh && touch ~/.ssh/config && grep -q "Include ~/Projects/Dotfiles/ssh/config" ~/.ssh/config || echo "Include ~/Projects/Dotfiles/ssh/config" >> ~/.ssh/config',
        Configuring SSH (Include),
      ]
